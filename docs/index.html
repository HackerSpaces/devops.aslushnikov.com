<meta charset='utf-8'>
<title>DevOps - Playwright</title>
<link rel="icon" href="/favicon.svg">
<link rel=stylesheet href=./typography.css>
<link rel=stylesheet href=./docker-size.css>
<link rel=stylesheet href=./cdn-status.css>
<link rel=stylesheet href=./autoroll.css>

<style>
  .gallery {
    margin: 0 auto;
    padding: 20px;
    max-width: 1200px;
    display: grid;
    grid-gap: 15px;
    grid-template-columns: repeat(auto-fit, minmax(550px, 1fr));
    grid-auto-flow: dense;
  }

  .tile {
    border: 1px solid var(--border-color);
    border-radius: 10px;
    box-shadow: 2px 2px 5px 0px #EEEEEE;
  }

  .cronjobs-status {
    background-color: #434449;
    padding: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    flex-wrap: wrap;
  }
      .cronjobs-status a:not(.ghlogo) {
        margin: 2 5px;
      }

      .cronjobs-status .ghlogo {
        position: absolute;
        width: 22px;
        margin-right: 5px;
        right: 0;
      }
</style>

<script type=module>
  import {html} from './zhtml.js';
  import {fetchCDNStatus, renderWebkitCDNStatus, renderFirefoxCDNStatus} from './cdn-status.js';
  import {fetchDockerStats, dockerSizeStats} from './docker-size.js';
  import {fetchAutorollData, renderAutorollData} from './autoroll.js';
  import {cronjobBadges} from './cronjobs.js';

  window.addEventListener('DOMContentLoaded', async () => {
    const [cdnData, dockerData, firefoxAutorollData, webkitAutorollData] = await Promise.all([
      fetchCDNStatus(),
      fetchDockerStats(),
      fetchAutorollData('Firefox'),
      fetchAutorollData('WebKit'),
    ]);

    document.body.append(html`
      <div class=cronjobs-status>
        ${cronjobBadges()}
        <a class=ghlogo href="https://github.com/aslushnikov/devops.aslushnikov.com" aria-label="View source on GitHub"><img width=22px src='/github.png'></a>
      </div>
      <div class="gallery">
        <div class=tile>${renderAutorollData(firefoxAutorollData, true /* preview */)}</div>
        <div class=tile>${renderAutorollData(webkitAutorollData, true /* preview */)}</div>
        <div class=tile>${renderWebkitCDNStatus(cdnData, true /* preview */)}</div>
        <div class=tile>${renderFirefoxCDNStatus(cdnData, true /* preview */)}</div>
        <div class=tile>${dockerSizeStats(dockerData, true /* preview */)}</div>
      </div>
    `);
  }, false);
</script>
